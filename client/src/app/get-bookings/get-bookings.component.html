<div class="container">
    <h2>Bookings</h2>
    <div *ngIf="showSuccessMessage" class="alert alert-success">{{ successMessage }}</div>
    <div *ngIf="showError" class="alert alert-danger">{{ errorMessage }}</div>
    
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Sr#</th>
                <th>Car</th>
                <th>Rental Start Date</th>
                <th>Rental End Date</th>
                <th>Amount</th>
                <th>Status</th>
                <th>User</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let booking of bookings; let i = index">
                <td>{{ i + 1 }}</td>
                <td>{{ booking.car.make }} {{ booking.car.model }}</td>
                <td>{{ booking.rentalStartDate | date }}</td>
                <td>{{ booking.rentalEndDate | date }}</td>
                <td>{{ booking.totalAmount | currency:'INR' }}</td>
                <td>{{ booking.status }}</td>
                <td>{{ booking.user.username }}</td>
                <td>
                    <button *ngIf="booking.status === 'Pending'" class="btn btn-success" (click)="acceptBooking(booking.id, 'Process Payment')">Accept</button>
                    <button *ngIf="booking.status === 'Process Payment'" class="btn btn-primary" (click)="showPaymentForm(booking)">Payment</button>
                </td>
            </tr>
        </tbody>
    </table>
    
    <!-- Show form only when a booking is selected for payment -->
    <form *ngIf="selectedBooking" [formGroup]="itemForm" (ngSubmit)="createPayment()">
        <h3>Process Payment for Booking ID: {{ selectedBooking.id }}</h3>
        <div class="form-group">
            <label for="amount">Amount</label>
            <input type="number" id="amount" formControlName="amount" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="paymentDate">Payment Date</label>
            <input type="date" id="paymentDate" formControlName="paymentDate" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="paymentMethod">Payment Method</label>
            <select id="paymentMethod" formControlName="paymentMethod" class="form-control" required>
                <option value="">Select</option>
                <option value="credit-card">Credit Card</option>
                <option value="debit-card">Debit Card</option>
                <option value="paypal">Paypal</option>
                <option value="cashOnDelivery">Cash On Delivery</option>
            </select>
        </div>
        <div class="form-group">
            <label for="paymentStatus">Payment Status</label>
            <input type="text" id="paymentStatus" formControlName="paymentStatus" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary">Submit Payment</button>
    </form>
</div>